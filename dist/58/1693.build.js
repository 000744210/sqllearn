(self.webpackChunksqlitelearn=self.webpackChunksqlitelearn||[]).push([[1693],{1693:function(e,o,r){"use strict";r.r(o);var n=r(9654);o.default={question:"Show the total number of above and below average days for orders. If the number of orders is above or equal to the all-time average of orders then it is above average. Otherwise it is a below average day.",solution:"select \n  count(case when number_orders >= average then 1 end) as above_average,\n  count(case when number_orders < average then 0 end) as below_average\n  from ( -- run this sub query for better understanding\n  select \n    order_date, \n    number_orders, \n    avg(number_orders) over() as average\n    from (\n      select o.order_date, count(*) as number_orders\n      from order_details od\n      join orders o on o.order_id = od.order_id\n      join employees e on e.employee_id = o.employee_id\n      join products p on p.product_id = od.product_id\n      group by o.order_date\n    )\n)",alternativeSolutions:[],expectedOutput:null,usedTables:["orders","products","products"],hints:{keywordsUsed:["SELECT","count","avg","over","case","GROUP BY","join"],hintLines:[0,1,2,7]},expectedDBState:null,validator:function(e,o){return n.Z.hashColumns((null==o?void 0:o.values)||[],!1,!1)==n.Z.hashColumns(this.expectedOutput[0].values,!1,!1)},initalize:function(e){this.expectedOutput=e.exec(this.solution),this.expectedDBState=e}}}}]);